<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Escape Room Challenge</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #ff006e, #8338ec, #3a86ff, #06ffa5, #ff006e);
            background-size: 400% 400%;
            animation: gradientShift 6s ease infinite;
            color: #ffffff;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-x: hidden;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            25% { background-position: 100% 0%; }
            50% { background-position: 100% 100%; }
            75% { background-position: 0% 100%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            width: 90%;
            max-width: 800px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 20px;
            border: 3px solid transparent;
            border-image: linear-gradient(45deg, #ff006e, #8338ec, #3a86ff, #06ffa5) 1;
            box-shadow: 0 0 40px rgba(255, 0, 110, 0.4), 
                        0 0 80px rgba(131, 56, 236, 0.3),
                        0 0 120px rgba(58, 134, 255, 0.2),
                        inset 0 0 50px rgba(6, 255, 165, 0.1);
            position: relative;
            animation: containerGlow 2s ease-in-out infinite alternate;
        }

        @keyframes containerGlow {
            0% { 
                box-shadow: 0 0 40px rgba(255, 0, 110, 0.4), 
                           0 0 80px rgba(131, 56, 236, 0.3),
                           0 0 120px rgba(58, 134, 255, 0.2),
                           inset 0 0 50px rgba(6, 255, 165, 0.1);
            }
            100% { 
                box-shadow: 0 0 60px rgba(255, 0, 110, 0.6), 
                           0 0 100px rgba(131, 56, 236, 0.5),
                           0 0 140px rgba(58, 134, 255, 0.4),
                           inset 0 0 70px rgba(6, 255, 165, 0.2);
            }
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .title {
            font-size: 2.8rem;
            background: linear-gradient(45deg, #ff006e, #ffbe0b, #8338ec, #06ffa5, #3a86ff, #ff006e);
            background-size: 400% 400%;
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 20px rgba(255, 0, 110, 0.8), 0 0 40px rgba(131, 56, 236, 0.6);
            margin-bottom: 10px;
            animation: titleRainbow 3s ease-in-out infinite;
            filter: drop-shadow(0 0 10px rgba(255, 190, 11, 0.7));
        }

        @keyframes titleRainbow {
            0% { background-position: 0% 50%; }
            25% { background-position: 100% 0%; }
            50% { background-position: 100% 100%; }
            75% { background-position: 0% 100%; }
            100% { background-position: 0% 50%; }
        }

        .subtitle {
            font-size: 1.2rem;
            color: #f5f5f5;
            opacity: 0.8;
        }

        .timer {
            position: absolute;
            top: 20px;
            right: 20px;
            background: linear-gradient(45deg, rgba(233, 69, 96, 0.3), rgba(0, 212, 170, 0.3));
            background-size: 200% 200%;
            padding: 12px 18px;
            border-radius: 12px;
            border: 2px solid transparent;
            border-image: linear-gradient(45deg, #e94560, #00d4aa) 1;
            font-size: 1.1rem;
            font-weight: bold;
            display: none;
            animation: timerPulse 2s ease-in-out infinite, timerGradient 4s ease infinite;
            box-shadow: 0 4px 15px rgba(233, 69, 96, 0.3);
        }

        @keyframes timerPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes timerGradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .team-input-section {
            text-align: center;
            padding: 40px 20px;
        }

        .story-text {
            background: linear-gradient(45deg, rgba(233, 69, 96, 0.1), rgba(0, 212, 170, 0.1), rgba(242, 113, 33, 0.1));
            background-size: 300% 300%;
            border: 2px solid transparent;
            border-image: linear-gradient(45deg, #e94560, #00d4aa, #f27121) 1;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            text-align: left;
            animation: storyGlow 5s ease-in-out infinite, storyBorder 6s linear infinite;
            position: relative;
            overflow: hidden;
        }

        @keyframes storyGlow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        @keyframes storyBorder {
            0% { border-image: linear-gradient(45deg, #e94560, #00d4aa, #f27121) 1; }
            33% { border-image: linear-gradient(45deg, #f27121, #e94560, #00d4aa) 1; }
            66% { border-image: linear-gradient(45deg, #00d4aa, #f27121, #e94560) 1; }
            100% { border-image: linear-gradient(45deg, #e94560, #00d4aa, #f27121) 1; }
        }

        .story-text p {
            font-size: 1.1rem;
            line-height: 1.6;
            color: #f5f5f5;
            margin: 0;
            text-align: justify;
        }

        .team-input-section h2 {
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: #f5f5f5;
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-group input {
            width: 100%;
            max-width: 300px;
            padding: 15px;
            font-size: 1.1rem;
            background: linear-gradient(45deg, rgba(255, 255, 255, 0.1), rgba(0, 212, 170, 0.05));
            border: 2px solid #e94560;
            border-radius: 8px;
            color: #f5f5f5;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
        }

        .input-group input::placeholder {
            color: rgba(245, 245, 245, 0.6);
        }

        .input-group input:focus {
            outline: none;
            border: 2px solid transparent;
            border-image: linear-gradient(45deg, #f27121, #00d4aa, #e94560) 1;
            box-shadow: 0 0 20px rgba(233, 69, 96, 0.4), 0 0 30px rgba(0, 212, 170, 0.2);
            transform: scale(1.02);
            background: linear-gradient(45deg, rgba(255, 255, 255, 0.15), rgba(0, 212, 170, 0.1));
        }

        .btn {
            background: linear-gradient(45deg, #ff006e, #ffbe0b, #8338ec, #06ffa5, #ff006e);
            background-size: 400% 400%;
            color: white;
            border: none;
            padding: 16px 32px;
            font-size: 1.1rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
            font-weight: bold;
            position: relative;
            overflow: hidden;
            animation: buttonGradient 2s ease infinite;
            box-shadow: 0 6px 20px rgba(255, 0, 110, 0.4), 0 0 30px rgba(131, 56, 236, 0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.4s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-4px) scale(1.08);
            box-shadow: 0 12px 35px rgba(255, 0, 110, 0.6), 
                        0 0 50px rgba(131, 56, 236, 0.5),
                        0 0 80px rgba(6, 255, 165, 0.3);
        }

        @keyframes buttonGradient {
            0% { background-position: 0% 50%; }
            25% { background-position: 100% 0%; }
            50% { background-position: 100% 100%; }
            75% { background-position: 0% 100%; }
            100% { background-position: 0% 50%; }
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .game-section {
            display: none;
        }

        .riddle {
            margin-bottom: 30px;
            padding: 25px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.05), rgba(0, 212, 170, 0.08), rgba(242, 113, 33, 0.05));
            background-size: 300% 300%;
            border-radius: 10px;
            border-left: 5px solid transparent;
            border-image: linear-gradient(45deg, #e94560, #00d4aa) 1;
            display: none;
            position: relative;
            overflow: hidden;
        }

        .riddle::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent, rgba(233, 69, 96, 0.05), transparent);
            animation: riddleShimmer 4s ease-in-out infinite;
            pointer-events: none;
        }

        .riddle.active {
            display: block;
            animation: fadeIn 0.8s cubic-bezier(0.4, 0, 0.2, 1), riddleBackground 6s ease infinite;
        }

        @keyframes fadeIn {
            from { 
                opacity: 0; 
                transform: translateY(30px) scale(0.9); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }

        @keyframes riddleBackground {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        @keyframes riddleShimmer {
            0% { transform: translateX(-100%) rotate(45deg); }
            100% { transform: translateX(300%) rotate(45deg); }
        }

        .riddle h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #f27121;
        }

        .riddle-content {
            margin-bottom: 20px;
        }

        .riddle-image {
            width: 100%;
            max-width: 400px;
            height: auto;
            border-radius: 8px;
            border: 2px solid #e94560;
            margin: 20px auto;
            display: block;
        }

        .riddle-text {
            font-size: 1.1rem;
            line-height: 1.6;
            color: #f5f5f5;
            margin-bottom: 15px;
        }

        .answer-input {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .answer-input input {
            flex: 1;
            min-width: 200px;
            padding: 12px;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid #e94560;
            border-radius: 8px;
            color: #f5f5f5;
        }

        .answer-input input:focus {
            outline: none;
            border-color: #f27121;
            box-shadow: 0 0 8px rgba(242, 113, 33, 0.3);
        }

        .submit-btn {
            padding: 12px 20px;
            font-size: 1rem;
        }

        .feedback {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            font-weight: bold;
        }

        .feedback.correct {
            background: rgba(76, 175, 80, 0.2);
            color: #4caf50;
            border: 1px solid #4caf50;
        }

        .feedback.incorrect {
            background: rgba(244, 67, 54, 0.2);
            color: #f44336;
            border: 1px solid #f44336;
        }

        .victory-section {
            display: none;
            text-align: center;
            padding: 40px 20px;
        }

        .victory-section h2 {
            font-size: 2.5rem;
            background: linear-gradient(45deg, #4caf50, #00d4aa, #f27121, #4caf50);
            background-size: 300% 300%;
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            animation: victoryPulse 2s infinite, victoryRainbow 4s ease infinite;
            text-shadow: 0 0 20px rgba(76, 175, 80, 0.5);
        }

        @keyframes victoryPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes victoryRainbow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .victory-stats {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .victory-stats p {
            font-size: 1.2rem;
            margin: 10px 0;
            color: #f5f5f5;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .progress-bar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: progressShimmer 2s ease-in-out infinite;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #ff006e, #ffbe0b, #8338ec, #06ffa5, #3a86ff, #ff006e);
            background-size: 300% 300%;
            width: 0%;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            animation: progressGradient 2s ease infinite;
            position: relative;
            box-shadow: 0 0 15px rgba(255, 0, 110, 0.6), 0 0 25px rgba(131, 56, 236, 0.4);
        }

        @keyframes progressShimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        @keyframes progressGradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @media (max-width: 600px) {
            .title {
                font-size: 2rem;
            }
            
            .container {
                width: 95%;
                padding: 15px;
            }
            
            .timer {
                position: static;
                margin-bottom: 20px;
                text-align: center;
            }
            
            .answer-input {
                flex-direction: column;
            }
            
            .answer-input input {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">üîê ESCAPE ROOM</h1>
            <p class="subtitle">Solve the riddles to escape!</p>
        </div>

        <div class="timer" id="timer">Time: 00:00</div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>

        <!-- Team Name Input Section -->
        <div class="team-input-section" id="teamInputSection">
            <div class="story-text">
                <p>The FPL Trophy ‚Äî The Golden Mug ‚Äî has mysteriously disappeared the night before the final league showdown. It's no ordinary mug. Legends say it brings luck, strategy, and victory to the team that holds it. Now locked inside the facility, you and your team are the only ones left who can crack the case. Time is ticking. You must solve puzzles, decode clues, and uncover the path room by room ‚Äî until you find the trophy and the one who dared to steal it.</p>
            </div>
            <h2>Enter Your Team Name</h2>
            <div class="input-group">
                <input type="text" id="teamNameInput" placeholder="Team Name" maxlength="30">
            </div>
            <button class="btn" onclick="startGame()">Start Game</button>
        </div>

        <!-- Game Section -->
        <div class="game-section" id="gameSection">
            <!-- Riddle 1 -->
            <div class="riddle" id="riddle1">
                <h3>üß© Riddle 1 of 3</h3>
                <div class="riddle-content">
                    <p class="riddle-text">Decode this visual cipher to find the secret code:</p>
                    <svg class="riddle-image" viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
                        <!-- Background -->
                        <rect width="400" height="300" fill="#1a1a2e"/>
                        
                        <!-- Title -->
                        <text x="200" y="30" text-anchor="middle" fill="#e94560" font-size="18" font-family="monospace">CIPHER MATRIX</text>
                        
                        <!-- Grid -->
                        <g stroke="#e94560" stroke-width="1" fill="none">
                            <line x1="50" y1="60" x2="350" y2="60"/>
                            <line x1="50" y1="110" x2="350" y2="110"/>
                            <line x1="50" y1="160" x2="350" y2="160"/>
                            <line x1="50" y1="210" x2="350" y2="210"/>
                            <line x1="50" y1="60" x2="50" y2="210"/>
                            <line x1="125" y1="60" x2="125" y2="210"/>
                            <line x1="200" y1="60" x2="200" y2="210"/>
                            <line x1="275" y1="60" x2="275" y2="210"/>
                            <line x1="350" y1="60" x2="350" y2="210"/>
                        </g>
                        
                        <!-- Letters and symbols -->
                        <text x="87" y="90" text-anchor="middle" fill="#f5f5f5" font-size="24" font-family="monospace">C</text>
                        <text x="162" y="90" text-anchor="middle" fill="#f5f5f5" font-size="24" font-family="monospace">3</text>
                        <text x="237" y="90" text-anchor="middle" fill="#f5f5f5" font-size="24" font-family="monospace">T</text>
                        <text x="312" y="90" text-anchor="middle" fill="#f5f5f5" font-size="24" font-family="monospace">20</text>
                        
                        <text x="87" y="140" text-anchor="middle" fill="#f5f5f5" font-size="24" font-family="monospace">19</text>
                        <text x="162" y="140" text-anchor="middle" fill="#f5f5f5" font-size="24" font-family="monospace">S</text>
                        <text x="237" y="140" text-anchor="middle" fill="#f5f5f5" font-size="24" font-family="monospace">2</text>
                        <text x="312" y="140" text-anchor="middle" fill="#f5f5f5" font-size="24" font-family="monospace">B</text>
                        
                        <!-- Arrows pointing to solution -->
                        <polygon points="87,190 92,180 82,180" fill="#f27121"/>
                        <polygon points="237,190 242,180 232,180" fill="#f27121"/>
                        <polygon points="162,190 167,180 157,180" fill="#f27121"/>
                        <polygon points="312,190 317,180 307,180" fill="#f27121"/>
                        
                        <!-- Hint text -->
                        <text x="200" y="240" text-anchor="middle" fill="#f27121" font-size="12" font-family="monospace">Read the letters in order</text>
                        <text x="200" y="260" text-anchor="middle" fill="#f27121" font-size="12" font-family="monospace">(Numbers are distractors)</text>
                    </svg>
                </div>
                <div class="answer-input">
                    <input type="text" id="answer1" placeholder="Enter the 4-letter code" maxlength="4">
                    <button class="btn submit-btn" onclick="checkAnswer(1)">Submit</button>
                </div>
                <div class="feedback" id="feedback1"></div>
            </div>

            <!-- Riddle 2 -->
            <div class="riddle" id="riddle2">
                <h3>üî¢ Riddle 2 of 3</h3>
                <div class="riddle-content">
                    <p class="riddle-text">I am a number that when reversed becomes 25% larger. What am I?</p>
                    <p class="riddle-text" style="font-style: italic; opacity: 0.8;">Hint: Think of two-digit numbers and their reverses.</p>
                </div>
                <div class="answer-input">
                    <input type="number" id="answer2" placeholder="Enter the number">
                    <button class="btn submit-btn" onclick="checkAnswer(2)">Submit</button>
                </div>
                <div class="feedback" id="feedback2"></div>
            </div>

            <!-- Riddle 3 -->
            <div class="riddle" id="riddle3">
                <h3>üé≠ Riddle 3 of 3</h3>
                <div class="riddle-content">
                    <p class="riddle-text">In a room with no windows and no doors, there is a table, a mirror, and a saw. How do you get out?</p>
                    <p class="riddle-text" style="font-style: italic; opacity: 0.8;">Hint: Think about wordplay and what you can do with these objects.</p>
                </div>
                <div class="answer-input">
                    <input type="text" id="answer3" placeholder="How do you escape?" maxlength="50">
                    <button class="btn submit-btn" onclick="checkAnswer(3)">Submit</button>
                </div>
                <div class="feedback" id="feedback3"></div>
            </div>
        </div>

        <!-- Victory Section -->
        <div class="victory-section" id="victorySection">
            <h2>üéâ ESCAPE SUCCESSFUL! üéâ</h2>
            <div class="victory-stats">
                <p><strong>Team:</strong> <span id="finalTeamName"></span></p>
                <p><strong>Time:</strong> <span id="finalTime"></span></p>
                <p><strong>Riddles Solved:</strong> 3/3</p>
            </div>
            <p style="font-size: 1.2rem; color: #f5f5f5; margin-top: 20px;">
                Congratulations! You have successfully escaped the room!
            </p>
            <button class="btn" onclick="resetGame()" style="margin-top: 20px;">Play Again</button>
        </div>
    </div>

    <script>
        // Audio Context for sound effects
        let audioContext;
        
        // Initialize audio context
        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        // Sound effect functions
        function playSound(frequency, duration, type = 'sine', volume = 0.3) {
            initAudio();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
            oscillator.type = type;
            
            gainNode.gain.setValueAtTime(0, audioContext.currentTime);
            gainNode.gain.linearRampToValueAtTime(volume, audioContext.currentTime + 0.01);
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + duration);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + duration);
        }

        function playButtonClick() {
            playSound(800, 0.1, 'square', 0.2);
        }

        function playCorrectAnswer() {
            // Play a rising chord
            setTimeout(() => playSound(523, 0.3, 'sine', 0.3), 0);    // C
            setTimeout(() => playSound(659, 0.3, 'sine', 0.3), 100);  // E
            setTimeout(() => playSound(784, 0.4, 'sine', 0.3), 200);  // G
        }

        function playIncorrectAnswer() {
            // Play a descending sound
            playSound(400, 0.2, 'triangle', 0.3);
            setTimeout(() => playSound(300, 0.3, 'triangle', 0.3), 100);
        }

        function playVictorySound() {
            // Play a victory fanfare
            const melody = [523, 659, 784, 1047, 1047, 1047];
            melody.forEach((freq, index) => {
                setTimeout(() => playSound(freq, 0.3, 'sine', 0.3), index * 150);
            });
        }

        function playTimerTick() {
            playSound(1000, 0.05, 'square', 0.1);
        }

        // Game state
        let gameState = {
            teamName: '',
            currentRiddle: 1,
            riddlesSolved: 0,
            startTime: null,
            endTime: null,
            timerInterval: null
        };

        // Correct answers for each riddle
        const answers = {
            1: 'CTSB', // From the visual cipher
            2: 36,     // 36 reversed is 63, which is 75% more than 36 (36 * 1.75 = 63)
            3: ['cut the table in half', 'saw the table in half', 'cut table in half', 'saw table in half', 'use the saw to cut the table']
        };

        // Start the game
        function startGame() {
            playButtonClick();
            const teamNameInput = document.getElementById('teamNameInput');
            const teamName = teamNameInput.value.trim();
            
            if (!teamName) {
                playIncorrectAnswer();
                alert('Please enter a team name!');
                return;
            }
            
            gameState.teamName = teamName;
            gameState.startTime = new Date();
            
            // Hide team input section and show game section
            document.getElementById('teamInputSection').style.display = 'none';
            document.getElementById('gameSection').style.display = 'block';
            document.getElementById('timer').style.display = 'block';
            
            // Show first riddle
            showRiddle(1);
            
            // Start timer
            startTimer();
            
            // Update progress
            updateProgress();
        }

        // Show specific riddle
        function showRiddle(riddleNumber) {
            // Hide all riddles
            for (let i = 1; i <= 3; i++) {
                document.getElementById(`riddle${i}`).classList.remove('active');
            }
            
            // Show current riddle
            document.getElementById(`riddle${riddleNumber}`).classList.add('active');
            gameState.currentRiddle = riddleNumber;
        }

        // Start timer
        function startTimer() {
            gameState.timerInterval = setInterval(updateTimer, 1000);
        }

        // Update timer display
        function updateTimer() {
            if (!gameState.startTime) return;
            
            const currentTime = new Date();
            const elapsed = Math.floor((currentTime - gameState.startTime) / 1000);
            
            // Play tick sound every 10 seconds
            if (elapsed > 0 && elapsed % 10 === 0) {
                playTimerTick();
            }
            
            const minutes = Math.floor(elapsed / 60);
            const seconds = elapsed % 60;
            
            const timeString = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('timer').textContent = `Time: ${timeString}`;
        }

        // Update progress bar
        function updateProgress() {
            const progress = (gameState.riddlesSolved / 3) * 100;
            document.getElementById('progressFill').style.width = `${progress}%`;
        }

        // Check answer for specific riddle
        function checkAnswer(riddleNumber) {
            playButtonClick();
            const answerInput = document.getElementById(`answer${riddleNumber}`);
            const feedback = document.getElementById(`feedback${riddleNumber}`);
            const userAnswer = answerInput.value.trim();
            
            if (!userAnswer) {
                playIncorrectAnswer();
                showFeedback(feedback, 'Please enter an answer!', false);
                return;
            }
            
            let isCorrect = false;
            
            // Check answer based on riddle number
            if (riddleNumber === 1) {
                isCorrect = userAnswer.toUpperCase() === answers[1];
            } else if (riddleNumber === 2) {
                isCorrect = parseInt(userAnswer) === answers[2];
            } else if (riddleNumber === 3) {
                const lowerAnswer = userAnswer.toLowerCase();
                isCorrect = answers[3].some(correctAnswer => 
                    lowerAnswer.includes(correctAnswer.toLowerCase())
                );
            }
            
            if (isCorrect) {
                playCorrectAnswer();
                showFeedback(feedback, '‚úÖ Correct! Well done!', true);
                gameState.riddlesSolved++;
                updateProgress();
                
                // Disable input and button
                answerInput.disabled = true;
                answerInput.nextElementSibling.disabled = true;
                
                // Move to next riddle or finish game
                setTimeout(() => {
                    if (riddleNumber < 3) {
                        showRiddle(riddleNumber + 1);
                    } else {
                        finishGame();
                    }
                }, 1500);
            } else {
                playIncorrectAnswer();
                showFeedback(feedback, '‚ùå Incorrect. Try again!', false);
                
                // Clear input for retry
                setTimeout(() => {
                    answerInput.focus();
                }, 1000);
            }
        }

        // Show feedback message
        function showFeedback(feedbackElement, message, isCorrect) {
            feedbackElement.textContent = message;
            feedbackElement.className = `feedback ${isCorrect ? 'correct' : 'incorrect'}`;
            feedbackElement.style.display = 'block';
        }

        // Finish the game
        function finishGame() {
            playVictorySound();
            gameState.endTime = new Date();
            clearInterval(gameState.timerInterval);
            
            // Calculate final time
            const totalSeconds = Math.floor((gameState.endTime - gameState.startTime) / 1000);
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            const finalTimeString = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // Update victory section
            document.getElementById('finalTeamName').textContent = gameState.teamName;
            document.getElementById('finalTime').textContent = finalTimeString;
            
            // Hide game section and show victory section
            document.getElementById('gameSection').style.display = 'none';
            document.getElementById('victorySection').style.display = 'block';
            document.getElementById('timer').style.display = 'none';
        }

        // Reset game
        function resetGame() {
            playButtonClick();
            
            // Reset game state
            gameState = {
                teamName: '',
                currentRiddle: 1,
                riddlesSolved: 0,
                startTime: null,
                endTime: null,
                timerInterval: null
            };
            
            // Reset UI
            document.getElementById('teamNameInput').value = '';
            document.getElementById('victorySection').style.display = 'none';
            document.getElementById('teamInputSection').style.display = 'block';
            document.getElementById('timer').style.display = 'none';
            document.getElementById('progressFill').style.width = '0%';
            
            // Reset all riddle inputs and feedback
            for (let i = 1; i <= 3; i++) {
                const answerInput = document.getElementById(`answer${i}`);
                const feedback = document.getElementById(`feedback${i}`);
                const submitBtn = answerInput.nextElementSibling;
                
                answerInput.value = '';
                answerInput.disabled = false;
                submitBtn.disabled = false;
                feedback.style.display = 'none';
                
                document.getElementById(`riddle${i}`).classList.remove('active');
            }
            
            // Clear timer interval if exists
            if (gameState.timerInterval) {
                clearInterval(gameState.timerInterval);
            }
        }

        // Add enter key support for inputs
        document.addEventListener('DOMContentLoaded', function() {
            // Team name input
            document.getElementById('teamNameInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    startGame();
                }
            });
            
            // Answer inputs
            for (let i = 1; i <= 3; i++) {
                document.getElementById(`answer${i}`).addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        checkAnswer(i);
                    }
                });
            }
        });
    </script>
</body>
</html>
